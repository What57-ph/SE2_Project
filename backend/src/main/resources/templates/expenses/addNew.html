<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/fdd309eb2f.js" crossorigin="anonymous"></script>
    <link type="text/css" rel="stylesheet" th:href="@{/css/expense.css}">
    <script th:src="@{/js/expense.js}" type="module"></script>
</head>
<body>

<div class="expense-header d-flex justify-content-between align-items-center">
    <div class="w-100 h-100 expense-header-left">
        <img src="/img/login-head.png" class="img-fluid">
        <span class="px-4">MoneyNote</span>
    </div>
    <div class="w-100 h-100 expense-header-right d-flex justify-content-evenly align-items-center">
        <form class="fs-2 fw-medium position-relative">
            <input title="Search" placeholder="Search" class="border-0">
            <i class="fa-solid fa-magnifying-glass position-absolute start-0 top-50 translate-middle ms-5"></i>
        </form>
        <img src="/img/avatar-Photoroom.png" class="img-fluid">
    </div>

</div>
<div class="expense-body d-flex position-relative">
    <div class="expense-sidebar py-5 position-relative">
        <h1 class="fw-bold text-center">Home</h1>
        <p class="p-5 mt-5">
            <span><i class="fa-solid fa-pen-nib"></i></span>
            <span>Expense</span>
        </p>
        <p class="p-5 mt-5">
            <span><i class="fa-regular fa-calendar"></i></span>
            <span>Calendar</span>
        </p>
        <p class="p-5 mt-5">
            <span><i class="fa-solid fa-chart-pie"></i></span>
            <span>Report</span>
        </p>
        <strong class="translate-middle"><i class="fa-solid fa-gear"></i></strong>

    </div>
    <div class="expense-body-content">
        <form th:action="@{/transactions/addExpense}" th:object="${transaction}" method="post">
            <!-- Hidden type field -->
            <input th:field="*{type}" type="hidden" id="selectedType">

            <!-- Transaction Type (Expense / Income) Buttons -->
            <p class="d-flex justify-content-evenly fw-bold">
                <span th:onclick="setTransactionType('EXPENSE')" th:text="'Expense'" th:attr="class=${transaction.type == 'EXPENSE' ? 'selected' : ''}">Expense</span>
                <span th:onclick="setTransactionType('INCOME')" th:text="'Income'" th:attr="class=${transaction.type == 'INCOME' ? 'selected' : ''}">Income</span>
            </p>

            <!-- Date Field -->
            <div class="row expense-row">
                <span class="fw-bold col-2">Date</span>
                <div class="col-7 d-flex gap-3 row-one">
                    <i class="fa-solid fa-chevron-left" id="previous-day"></i>
                    <input th:field="*{transactionDate}" class="col-7 p-2 ps-4" type="date" name="transactionDate" id="createdDate">
                    <i class="fa-solid fa-chevron-right" id="next-day"></i>
                </div>
            </div>

            <!-- Note Field -->
            <div class="row expense-row">
                <span class="fw-bold col-2">Note</span>
                <div class="col-7 position-relative">
                    <input th:field="*{notes}" class="p-2 ps-4 fw-light w-100 pe-5" type="text" name="notes" placeholder="Enter here">
                    <i class="fa-solid fa-book-open position-absolute end-0 top-50 translate-middle me-2 fs-1"></i>
                </div>
            </div>

            <!-- Amount Field -->
            <div class="row expense-row">
                <span class="fw-bold col-2">Amount</span>
                <div class="col-7 position-relative">
                    <input th:field="*{amount}" class="p-2 ps-4 fw-light w-100 pe-5" type="text" name="amount" placeholder="0">
                    <span class="position-absolute end-0 top-50 translate-middle me-2 fw-light">vnd</span>
                </div>
            </div>

            <!-- Category Field (Dynamic Category List) -->
            <div class="category-choosing mt-5">
                <p>
                    <i class="fa-solid fa-list bg-success p-3 text-center"></i>
                    <span>Choose category</span>
                </p>
                <input th:field="*{categoryId}" type="hidden" name="categoryId" id="selectedCategory">

                <div class="category-list d-flex gap-5 justify-content-center mt-5">
                    <!-- Loop through categories and create a clickable list -->
                    <div class="category-list-item text-center bg-white" th:each="category : ${categories}" th:attr="data-id=${category.id}"  onclick="setCategory(${category.id})">
                        <i class="fa-solid fa-utensils"></i>
                        <p th:text="${category.name}"></p>
                    </div>

                </div>
            </div>

            <button type="submit" class="add-button enter-button btn fs-1 px-4 position-relative bottom-0 start-50 translate-middle btn-danger">
                Enter
            </button>
        </form>

    </div>
</div>

<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", function() {
        const categoryButtons = document.querySelectorAll('.category-list-item');  // Lấy tất cả các nút category
        categoryButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                const categoryId = event.currentTarget.getAttribute('data-id');  // Lấy ID của category
                document.getElementById("selectedCategory").value = categoryId;  // Cập nhật giá trị vào input ẩn
                console.log("Selected Category ID: " + categoryId);  // In ra ID của category để kiểm tra
            });
        });
    });
    function setCategory(id) {
        document.getElementById("selectedCategory").value = id;
        console.log("Selected Category ID: " + id);  // Để kiểm tra trong Console
    }
</script></body>
</html>
